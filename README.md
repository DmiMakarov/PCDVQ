# PCDVQ

Implementation of the paper on PCDVQ

## Results

#### QWEN3-0.6B

| Metric          | Original |   Quantized | E8_16_2  | E8P_16_2 | E8_14_2  | E8P_14_2 | E8_12_2  | E8P_12_2 | E8_10_2   | E8P_10_2   |   E8_8_2   |   E8P_8_2  |
| --------------- | -------: | ----------: | -------: | -------: | -------: | -------: | -------: | -------: | --------: | ---------: | ---------: | ---------: |
| bits_per_byte   |   0.9115 |      1.5815 |   1.4876 |   1.4557 |   1.6491 |   1.7767 |   2.4508 |    2.5225|     3.2682|      4.0001|      3.8711|      4.2938|
| byte_perplexity |   1.8810 |      2.9928 |   2.8042 |   2.7429 |   3.1364 |   3.4264 |   5.4671 |    5.7459|     9.6341|     16.0009|     14.6322|     19.6134|
| word_perplexity |  29.3252 |    351.4114 | 248.1146 | 220.4340 | 451.5082 | 724.4618 |8812.5543 |11498.5614|182344.4396|2748541.0187|1703884.6350|8163146.5682|


#### QWEN3-4B

| Metric          | Original | E8_16_2  | E8P_16_2 | E8_14_2  | E8P_14_2 | E8_12_2  | E8P_12_2 | E8_10_2   | E8P_10_2   |   E8_8_2   |   E8P_8_2  |
| --------------- | -------: | -------: | -------: | -------: | -------: | -------: | -------: | --------: | ---------: | ---------: | ---------: |
| bits_per_byte   |   0.9115 |   1.4876 |   1.4557 |   1.6491 |   1.7767 |   2.4508 |    2.5225|     3.2682|      4.0001|      3.8711|      4.2938|
| byte_perplexity |   1.8810 |   2.8042 |   2.7429 |   3.1364 |   3.4264 |   5.4671 |    5.7459|     9.6341|     16.0009|     14.6322|     19.6134|
| word_perplexity |  29.3252 | 248.1146 | 220.4340 | 451.5082 | 724.4618 |8812.5543 |11498.5614|182344.4396|2748541.0187|1703884.6350|8163146.5682|



#### QWEN3-8B

| Metric          | Original | E8_16_2  | E8P_16_2 | E8_14_2  | E8P_14_2 | E8_12_2  | E8P_12_2 | E8_10_2   | E8P_10_2   |   E8_8_2   |   E8P_8_2  |
| --------------- | -------: | -------: | -------: | -------: | -------: | -------: | -------: | --------: | ---------: | ---------: | ---------: |
| bits_per_byte   |    0.7015|   1.4876 |   1.4557 |   1.6491 |   1.7767 |   2.4508 |    2.5225|     3.2682|      4.0001|      3.8711|      4.2938|
| byte_perplexity |    1.6262|   2.8042 |   2.7429 |   3.1364 |   3.4264 |   5.4671 |    5.7459|     9.6341|     16.0009|     14.6322|     19.6134|
| word_perplexity |   13.4642| 248.1146 | 220.4340 | 451.5082 | 724.4618 |8812.5543 |11498.5614|182344.4396|2748541.0187|1703884.6350|8163146.5682|


 #### Simple model (Linear on MNIST)

| Codebook bits| Accuracy e8 | Accuracy e8P |
|-------------:|------------:| -----------: |
| W/O          |    0.863783 |    0.863783  |
| 8_2          |    0.826283 |    0.779383  |
| 10_2         |    0.838266 |    0.796283  |
| 12_2         |    0.849016 |    0.817733  |
| 14_2         |    0.85315  |    0.84685   |
| 16_2         |    0.855466 |    0.85496   |
